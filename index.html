<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</title>
    <style>
        /* –í–ê–ñ–ù–û: –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô */
        /* –ü–æ–ª–Ω—ã–π CSS –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --bg-primary: #2f2f2f;
            --bg-secondary: #252525;
            --bg-tertiary: #4a4a4a;
            --bg-dark-controls: #1a1a1a;
            --accent-color: #e67e22;
            --accent-hover: #d35400;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
            --border-color: #4a4a4a;
            --table-bg: #3a3a3a;
            --table-border: #4a4a4a;
            --table-header-bg: #1a1a1a;
            --table-hover: #5a5a5a;
        }

        /* ... –í–°–ï –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ... */

    </style>
</head>
<body class="theme-orange">
    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="login-screen">
        <div class="login-container">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="main-screen">
        <!-- ... –í–°–Ø HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ... -->
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <!-- ... –í–°–ï –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô ... -->

    <script>
        // ========== StorageManager Class ==========
        class StorageManager {
            constructor() {
                this.GITHUB_CONFIG = {
                    token: localStorage.getItem('githubToken') || '',
                    repo: localStorage.getItem('githubRepo') || 'viktor15081985/Transort',
                    branch: localStorage.getItem('githubBranch') || 'main'
                };
                
                this.pendingChanges = JSON.parse(localStorage.getItem('pendingChanges')) || [];
                this.isSyncing = false;
                this.syncRetryCount = 0;
                this.MAX_SYNC_RETRIES = 3;
                this.syncRetryTimeout = null;
            }

            // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            getAllAppData(users, appSettings, tabs, currentUser) {
                return {
                    users: users,
                    appSettings: appSettings,
                    tabs: tabs,
                    lastSync: new Date().toISOString(),
                    lastEditor: currentUser.username
                };
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
            saveToLocalStorage(users, appSettings, tabs) {
                try {
                    localStorage.setItem('users', JSON.stringify(users));
                    localStorage.setItem('appSettings', JSON.stringify(appSettings));
                    localStorage.setItem('tabs', JSON.stringify(tabs));
                    
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ localStorage');
                    return true;
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', error);
                    return false;
                }
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
            loadFromLocalStorage() {
                try {
                    const users = JSON.parse(localStorage.getItem('users')) || [];
                    const appSettings = JSON.parse(localStorage.getItem('appSettings')) || {};
                    const tabs = JSON.parse(localStorage.getItem('tabs')) || [];
                    const pendingChanges = JSON.parse(localStorage.getItem('pendingChanges')) || [];
                    
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage');
                    return {
                        users,
                        appSettings,
                        tabs,
                        pendingChanges
                    };
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:', error);
                    return this.getDefaultData();
                }
            }

            // –î–∞–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            getDefaultData() {
                const defaultTab = {
                    id: 'tab1',
                    name: '–û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ',
                    tableData: [
                        { id: 1, name: '–ü—Ä–æ–µ–∫—Ç –ê', date: '01.10.2023', status: '–ê–∫—Ç–∏–≤–µ–Ω', customData: {}, attachments: {} },
                        { id: 2, name: '–ü—Ä–æ–µ–∫—Ç –ë', date: '05.10.2023', status: '–ó–∞–≤–µ—Ä—à–µ–Ω', customData: {}, attachments: {} },
                        { id: 3, name: '–ü—Ä–æ–µ–∫—Ç –í', date: '10.10.2023', status: '–í –ø—Ä–æ—Ü–µ—Å—Å–µ', customData: {}, attachments: {} }
                    ],
                    customButtons: [],
                    customColumns: [],
                    basicColumns: [
                        { id: 'id', name: '‚Ññ –ø/–ø', editable: false },
                        { id: 'name', name: '–ù–∞–∑–≤–∞–Ω–∏–µ', editable: true },
                        { id: 'date', name: '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', editable: true },
                        { id: 'status', name: '–°—Ç–∞—Ç—É—Å', editable: true }
                    ],
                    dateValidationColumns: {}
                };

                return {
                    users: [
                        { username: 'admin', password: 'admin', role: 'admin' },
                        { username: 'user', password: 'user', role: 'user' }
                    ],
                    appSettings: {
                        headerTitle: '–û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ',
                        headerLogo: '',
                        fixedColumnsCount: 3,
                        currentTheme: 'theme-orange'
                    },
                    tabs: [defaultTab],
                    pendingChanges: []
                };
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ GitHub - –£–ü–†–û–©–ï–ù–ù–ê–Ø –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
            async saveToGitHub(data, currentUser) {
                console.log('üîÑ –ù–∞—á–∏–Ω–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ GitHub...');
                
                if (!this.GITHUB_CONFIG.token) {
                    throw new Error('GitHub —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
                }

                if (!this.GITHUB_CONFIG.repo) {
                    throw new Error('–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ —É–∫–∞–∑–∞–Ω');
                }

                try {
                    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ base64
                    const content = btoa(unescape(encodeURIComponent(JSON.stringify(data, null, 2))));
                    
                    let sha = null;
                    
                    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Ñ–∞–π–ª–µ
                    try {
                        const fileInfoResponse = await fetch(
                            `https://api.github.com/repos/${this.GITHUB_CONFIG.repo}/contents/data.json?ref=${this.GITHUB_CONFIG.branch}`,
                            {
                                headers: {
                                    'Authorization': `token ${this.GITHUB_CONFIG.token}`,
                                    'Accept': 'application/vnd.github.v3+json'
                                }
                            }
                        );
                        
                        if (fileInfoResponse.ok) {
                            const fileInfo = await fileInfoResponse.json();
                            sha = fileInfo.sha;
                            console.log('‚úÖ –ü–æ–ª—É—á–µ–Ω SHA —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞:', sha);
                        } else if (fileInfoResponse.status === 404) {
                            console.log('üìù –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                        } else {
                            const errorData = await fileInfoResponse.json();
                            throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ: ${errorData.message}`);
                        }
                    } catch (error) {
                        console.log('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ:', error.message);
                        // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–µ–∑ SHA - —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω
                    }

                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ GitHub
                    const saveResponse = await fetch(
                        `https://api.github.com/repos/${this.GITHUB_CONFIG.repo}/contents/data.json`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${this.GITHUB_CONFIG.token}`,
                                'Content-Type': 'application/json',
                                'Accept': 'application/vnd.github.v3+json'
                            },
                            body: JSON.stringify({
                                message: `–ê–≤—Ç–æ-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ${new Date().toLocaleString()} (${currentUser.username})`,
                                content: content,
                                branch: this.GITHUB_CONFIG.branch,
                                sha: sha
                            })
                        }
                    );

                    if (!saveResponse.ok) {
                        const errorData = await saveResponse.json();
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', errorData);
                        
                        if (errorData.message && errorData.message.includes('sha')) {
                            // –ö–æ–Ω—Ñ–ª–∏–∫—Ç SHA - –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                            console.log('üîÑ –ö–æ–Ω—Ñ–ª–∏–∫—Ç SHA, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ...');
                            return { shaConflict: true, error: errorData };
                        }
                        
                        throw new Error(errorData.message || `–û—à–∏–±–∫–∞ HTTP: ${saveResponse.status}`);
                    }

                    const result = await saveResponse.json();
                    console.log('‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ GitHub:', result.commit.html_url);
                    
                    localStorage.setItem('lastSyncTime', new Date().toISOString());
                    return { success: true, commit: result.commit };

                } catch (error) {
                    console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ GitHub:', error);
                    throw error;
                }
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ GitHub - –£–ü–†–û–©–ï–ù–ù–ê–Ø –ò –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø
            async loadFromGitHub() {
                console.log('üì• –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∏–∑ GitHub...');
                
                if (!this.GITHUB_CONFIG.repo) {
                    throw new Error('–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω');
                }

                try {
                    const headers = {
                        'Accept': 'application/vnd.github.v3+json'
                    };
                    
                    if (this.GITHUB_CONFIG.token) {
                        headers['Authorization'] = `token ${this.GITHUB_CONFIG.token}`;
                    }

                    const response = await fetch(
                        `https://api.github.com/repos/${this.GITHUB_CONFIG.repo}/contents/data.json?ref=${this.GITHUB_CONFIG.branch}`,
                        { headers }
                    );

                    console.log('üì° –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞:', response.status);

                    if (response.status === 404) {
                        console.log('üìù –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        return { notFound: true };
                    }

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.message || `–û—à–∏–±–∫–∞ HTTP: ${response.status}`);
                    }

                    const fileInfo = await response.json();
                    
                    if (!fileInfo.content) {
                        throw new Error('–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç');
                    }

                    // –î–µ–∫–æ–¥–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
                    const content = decodeURIComponent(escape(atob(fileInfo.content)));
                    
                    if (!content.trim()) {
                        throw new Error('–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç');
                    }

                    const data = JSON.parse(content);
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub');
                    
                    return { success: true, data: data };

                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ GitHub:', error);
                    throw error;
                }
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
            async autoSyncChanges(data, currentUser, updateSyncStatus) {
                if (currentUser && currentUser.role === 'admin') {
                    console.log('üîÑ –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π...');
                    
                    const change = {
                        timestamp: Date.now(),
                        data: data,
                        user: currentUser.username
                    };
                    
                    this.pendingChanges.push(change);
                    localStorage.setItem('pendingChanges', JSON.stringify(this.pendingChanges));
                    
                    await this.trySyncChanges(updateSyncStatus);
                }
            }

            // –ü–æ–ø—ã—Ç–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            async trySyncChanges(updateSyncStatus) {
                if (this.isSyncing || this.pendingChanges.length === 0) {
                    return;
                }
                
                this.isSyncing = true;
                updateSyncStatus('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è...', 'syncing');
                
                const change = this.pendingChanges[0];
                
                try {
                    console.log('üîÑ –ü—ã—Ç–∞–µ–º—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è...');
                    const result = await this.saveToGitHub(change.data, change.user);
                    
                    if (result.shaConflict) {
                        console.log('üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç SHA, –ø–æ–≤—Ç–æ—Ä—è–µ–º...');
                        // –ü—Ä–æ—Å—Ç–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        const retryResult = await this.saveToGitHub(change.data, change.user);
                        
                        if (!retryResult.success) {
                            throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç SHA');
                        }
                    }
                    
                    // –£—Å–ø–µ—à–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                    this.pendingChanges.shift();
                    localStorage.setItem('pendingChanges', JSON.stringify(this.pendingChanges));
                    this.syncRetryCount = 0;
                    
                    updateSyncStatus('–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: ' + new Date().toLocaleTimeString(), 'success');
                    console.log('‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
                    
                    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
                    if (this.pendingChanges.length > 0) {
                        setTimeout(() => this.trySyncChanges(updateSyncStatus), 1000);
                    }
                    
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
                    this.syncRetryCount++;
                    
                    if (this.syncRetryCount <= this.MAX_SYNC_RETRIES) {
                        const delay = this.syncRetryCount * 2000;
                        updateSyncStatus(`–û—à–∏–±–∫–∞, –ø–æ–≤—Ç–æ—Ä —á–µ—Ä–µ–∑ ${delay/1000} —Å–µ–∫...`, 'error');
                        console.log(`üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ ${delay}–º—Å (${this.syncRetryCount}/${this.MAX_SYNC_RETRIES})`);
                        
                        this.syncRetryTimeout = setTimeout(() => {
                            this.trySyncChanges(updateSyncStatus);
                        }, delay);
                    } else {
                        updateSyncStatus('–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏', 'error');
                        console.error('‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫');
                    }
                } finally {
                    this.isSyncing = false;
                }
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ GitHub
            updateGitHubConfig(token, repo, branch) {
                this.GITHUB_CONFIG.token = token;
                this.GITHUB_CONFIG.repo = repo;
                this.GITHUB_CONFIG.branch = branch;
                
                localStorage.setItem('githubToken', token);
                localStorage.setItem('githubRepo', repo);
                localStorage.setItem('githubBranch', branch);
                
                console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
                return true;
            }

            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            getConfig() {
                return { ...this.GITHUB_CONFIG };
            }

            // –û—á–∏—Å—Ç–∫–∞ –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
            clearPendingChanges() {
                this.pendingChanges = [];
                localStorage.setItem('pendingChanges', JSON.stringify(this.pendingChanges));
                console.log('‚úÖ –û—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∏—â–µ–Ω—ã');
            }
        }

        // ========== –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ==========
        
        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä StorageManager
        const storageManager = new StorageManager();

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let users = [];
        let appSettings = {};
        let tabs = [];
        let currentUser = null;
        let currentTabId = 'tab1';
        let selectedRows = new Set();
        let searchTerm = '';
        let currentSort = { column: null, direction: 'asc' };
        let currentFilters = {};
        
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –í–ö–õ–ê–î–ö–ê–ú–ò
        function getCurrentTab() {
            return tabs.find(tab => tab.id === currentTabId);
        }

        function getCurrentTabData() {
            const currentTab = getCurrentTab();
            return currentTab ? currentTab.tableData : [];
        }

        function getCurrentTabCustomButtons() {
            const currentTab = getCurrentTab();
            return currentTab ? currentTab.customButtons : [];
        }

        function getCurrentTabCustomColumns() {
            const currentTab = getCurrentTab();
            return currentTab ? currentTab.customColumns : [];
        }

        function getCurrentTabBasicColumns() {
            const currentTab = getCurrentTab();
            return currentTab ? currentTab.basicColumns : [];
        }

        function getCurrentTabDateValidationColumns() {
            const currentTab = getCurrentTab();
            return currentTab ? currentTab.dateValidationColumns : {};
        }

        function updateCurrentTabData(newData) {
            const currentTab = getCurrentTab();
            if (currentTab) {
                currentTab.tableData = newData;
            }
        }

        // –ö–õ–Æ–ß–ï–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–†–û–ö–ò –°–û–°–¢–û–Ø–ù–ò–Ø
        function updateStatusBar() {
            if (!currentUser) return;
            
            const statusBar = document.getElementById('status-bar-header');
            const syncStatus = document.getElementById('sync-status-text');
            
            if (storageManager.pendingChanges.length > 0) {
                statusBar.classList.add('syncing');
                syncStatus.textContent = `–û–∂–∏–¥–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (${storageManager.pendingChanges.length})`;
            } else {
                statusBar.classList.remove('syncing');
                syncStatus.textContent = '–î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã';
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –û–ë–ù–û–í–õ–ï–ù–ò–Ø –°–¢–ê–¢–£–°–ê –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò
        function updateSyncStatus(message, type = '') {
            const statusElement = document.getElementById('sync-status-text');
            const statusBar = document.getElementById('status-bar-header');
            
            statusElement.textContent = message;
            statusBar.className = 'status-bar-header';
            
            if (type) {
                statusBar.classList.add(type);
            }
            
            console.log(`üì¢ –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: ${message}`);
        }

        // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò –ü–†–ò –ò–ó–ú–ï–ù–ï–ù–ò–Ø–•
        function autoSyncChanges() {
            if (currentUser && currentUser.role === 'admin') {
                const appData = storageManager.getAllAppData(users, appSettings, tabs, currentUser);
                storageManager.autoSyncChanges(appData, currentUser, updateSyncStatus);
                updateStatusBar();
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û–ì–û –°–û–•–†–ê–ù–ï–ù–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô
        async function forceSaveChanges() {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è');
                return;
            }

            if (storageManager.pendingChanges.length === 0) {
                alert('–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
                return;
            }
            
            storageManager.syncRetryCount = 0;
            if (storageManager.syncRetryTimeout) {
                clearTimeout(storageManager.syncRetryTimeout);
                storageManager.syncRetryTimeout = null;
            }
            
            await storageManager.trySyncChanges(updateSyncStatus);
            updateStatusBar();
        }

        // –£–õ–£–ß–®–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò –ò–ó GITHUB
        async function loadFromGitHub() {
            updateSyncStatus('–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ GitHub...', 'syncing');

            try {
                const result = await storageManager.loadFromGitHub();
                
                if (result.notFound) {
                    updateSyncStatus('–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω', '');
                    console.log('üìù –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                    return;
                }

                if (result.success && result.data) {
                    // –û–ë–ù–û–í–õ–Ø–ï–ú –í–°–ï –î–ê–ù–ù–´–ï –ò–ó GITHUB
                    users = result.data.users || users;
                    appSettings = result.data.appSettings || appSettings;
                    tabs = result.data.tabs || tabs;
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    storageManager.saveToLocalStorage(users, appSettings, tabs);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    renderTabs();
                    renderTable();
                    loadCustomButtons();
                    loadAppSettings();
                    
                    updateSyncStatus('–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ GitHub: ' + new Date().toLocaleTimeString(), 'success');
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã');
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ GitHub:', error);
                updateSyncStatus('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message, 'error');
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                loadFromLocalStorageWithNotification();
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ó–ê–ì–†–£–ó–ö–ò –ò–ó LOCALSTORAGE –° –£–í–ï–î–û–ú–õ–ï–ù–ò–ï–ú
        function loadFromLocalStorageWithNotification() {
            const data = storageManager.loadFromLocalStorage();
            
            users = data.users;
            appSettings = data.appSettings;
            tabs = data.tabs;
            storageManager.pendingChanges = data.pendingChanges;
            
            renderTabs();
            renderTable();
            loadCustomButtons();
            loadAppSettings();
            
            updateSyncStatus('–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', '');
            console.log('üìÅ –ó–∞–≥—Ä—É–∂–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage');
        }

        // –§–£–ù–ö–¶–ò–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        function initializeAppWithFallback() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            setupEventListeners();
            loadAppSettings();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            if (users.length === 0) {
                const data = storageManager.loadFromLocalStorage();
                users = data.users;
                appSettings = data.appSettings;
                tabs = data.tabs;
                storageManager.pendingChanges = data.pendingChanges;
            }
            
            // –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ GitHub
            if (currentUser && currentUser.role === 'user') {
                const config = storageManager.getConfig();
                if (config.token && config.repo) {
                    console.log('üîÑ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ GitHub –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                    loadFromGitHub();
                } else {
                    loadFromLocalStorageWithNotification();
                }
            } else {
                loadFromLocalStorageWithNotification();
            }
            
            updateStatusBar();
        }

        // –§–£–ù–ö–¶–ò–ò –†–ê–ë–û–¢–´ –° –î–ê–¢–ê–ú–ò
        function isValidDate(dateString) {
            const regex = /^\d{2}\.\d{2}\.\d{4}$/;
            if (!regex.test(dateString)) return false;
            
            const parts = dateString.split('.');
            const day = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1;
            const year = parseInt(parts[2], 10);
            
            const date = new Date(year, month, day);
            return date.getDate() === day && date.getMonth() === month && date.getFullYear() === year;
        }

        function parseDate(dateString) {
            if (!dateString) return new Date();
            const parts = dateString.split('.');
            const day = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1;
            const year = parseInt(parts[2], 10);
            
            return new Date(year, month, day);
        }

        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }

        // –ö–õ–Æ–ß–ï–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –°–û–ó–î–ê–ù–ò–ï –ö–ê–°–¢–û–ú–ù–û–ô –ö–ù–û–ü–ö–ò
        function createCustomButton(buttonData) {
            const buttonWrapper = document.createElement('div');
            buttonWrapper.className = 'custom-button-wrapper';
            
            const button = document.createElement('button');
            button.className = 'custom-button';
            button.dataset.buttonId = buttonData.id;
            button.dataset.columns = JSON.stringify(buttonData.columns);
            button.title = `–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã: ${buttonData.columns.join(', ')}`;
            
            const buttonText = document.createElement('span');
            buttonText.className = 'button-text';
            buttonText.textContent = buttonData.name;
            
            button.appendChild(buttonText);
            
            if (currentUser && currentUser.role === 'admin') {
                const actionsContainer = document.createElement('div');
                actionsContainer.className = 'button-actions';
                
                const editBtn = document.createElement('button');
                editBtn.className = 'btn-edit-small';
                editBtn.innerHTML = '‚úé';
                editBtn.title = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É';
                editBtn.onclick = (e) => {
                    e.stopPropagation();
                    editButton(buttonData.id);
                };
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'btn-danger-small';
                deleteBtn.innerHTML = '√ó';
                deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteButton(buttonData.id);
                };
                
                actionsContainer.appendChild(editBtn);
                actionsContainer.appendChild(deleteBtn);
                
                buttonWrapper.appendChild(button);
                buttonWrapper.appendChild(actionsContainer);
            } else {
                buttonWrapper.appendChild(button);
            }
            
            // –ö–õ–Æ–ß–ï–í–û–ô –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ
            button.addEventListener('click', function(e) {
                if (e.target.classList.contains('btn-edit-small') || 
                    e.target.classList.contains('btn-danger-small')) {
                    return;
                }
                
                const columnsToShow = JSON.parse(this.dataset.columns);
                console.log('üîÑ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã:', columnsToShow);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —è—á–µ–π–∫–∏
                const allCells = document.querySelectorAll('#data-table th, #data-table td');
                allCells.forEach(cell => {
                    cell.style.display = 'none';
                });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
                const fixedCount = appSettings.fixedColumnsCount || 3;
                for (let i = 0; i < fixedCount; i++) {
                    const headerCells = document.querySelectorAll(`#data-table th:nth-child(${i + 1})`);
                    const dataCells = document.querySelectorAll(`#data-table td:nth-child(${i + 1})`);
                    
                    headerCells.forEach(cell => cell.style.display = '');
                    dataCells.forEach(cell => cell.style.display = '');
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
                columnsToShow.forEach(colName => {
                    console.log(`üîç –ò—â–µ–º —Å—Ç–æ–ª–±–µ—Ü: ${colName}`);
                    
                    // –ò—â–µ–º –≤ –±–∞–∑–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
                    const basicHeaders = document.querySelectorAll('#data-table th');
                    basicHeaders.forEach(header => {
                        const headerText = header.querySelector('.th-title');
                        if (headerText && headerText.textContent === colName) {
                            header.style.display = '';
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —è—á–µ–π–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                            const colIndex = Array.from(header.parentNode.children).indexOf(header) + 1;
                            const dataCells = document.querySelectorAll(`#data-table td:nth-child(${colIndex})`);
                            dataCells.forEach(cell => cell.style.display = '');
                        }
                    });
                    
                    // –ò—â–µ–º –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö
                    const customHeaders = document.querySelectorAll(`th[data-column-name="${colName}"]`);
                    const customCells = document.querySelectorAll(`td[data-column-name="${colName}"]`);
                    
                    customHeaders.forEach(header => header.style.display = '');
                    customCells.forEach(cell => cell.style.display = '');
                    
                    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: ${customHeaders.length}, —è—á–µ–µ–∫: ${customCells.length}`);
                });
                
                // –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã –ø–æ—Å–ª–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
                setTimeout(() => {
                    checkAllDates();
                }, 100);
            });
            
            document.getElementById('custom-buttons').appendChild(buttonWrapper);
        }

        // –ö–õ–Æ–ß–ï–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –†–ï–ù–î–ï–†–ò–ù–ì –¢–ê–ë–õ–ò–¶–´
        function renderTable() {
            console.log('üîÑ –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã...');
            
            const thead = document.querySelector('#data-table thead tr');
            const tbody = document.querySelector('#data-table tbody');
            
            if (!thead || !tbody) {
                console.error('‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Ç–∞–±–ª–∏—Ü—ã');
                return;
            }
            
            // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            thead.innerHTML = '';
            tbody.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤
            const selectAllTh = document.createElement('th');
            selectAllTh.innerHTML = '<input type="checkbox" class="select-all-checkbox" id="select-all-checkbox" title="–í—ã–±—Ä–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏">';
            thead.appendChild(selectAllTh);
            
            // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã
            const basicColumns = getCurrentTabBasicColumns();
            const customColumns = getCurrentTabCustomColumns();
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–∞–∑–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
            basicColumns.forEach((column, index) => {
                const th = document.createElement('th');
                th.dataset.columnId = column.id;
                th.dataset.columnType = 'basic';
                th.dataset.columnIndex = index;
                
                const thContent = document.createElement('div');
                thContent.className = 'th-content';
                
                const thMain = document.createElement('div');
                thMain.className = 'th-main';
                
                const thTitle = document.createElement('div');
                thTitle.className = 'th-title';
                thTitle.textContent = column.name;
                thTitle.title = column.name;
                
                thMain.appendChild(thTitle);
                thContent.appendChild(thMain);
                th.appendChild(thContent);
                
                thead.appendChild(th);
            });
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
            customColumns.forEach((column, index) => {
                const th = document.createElement('th');
                th.dataset.columnId = column.id;
                th.dataset.columnType = 'custom';
                th.dataset.columnIndex = index;
                th.dataset.columnName = column.name; // –í–ê–ñ–ù–û: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è —Å—Ç–æ–ª–±—Ü–∞
                
                const thContent = document.createElement('div');
                thContent.className = 'th-content';
                
                const thMain = document.createElement('div');
                thMain.className = 'th-main';
                
                const thTitle = document.createElement('div');
                thTitle.className = 'th-title';
                thTitle.textContent = column.name;
                thTitle.title = column.name;
                
                thMain.appendChild(thTitle);
                thContent.appendChild(thMain);
                th.appendChild(thContent);
                
                thead.appendChild(th);
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
            if (currentUser && currentUser.role === 'admin') {
                const actionsTh = document.createElement('th');
                actionsTh.className = 'admin-only actions-header';
                actionsTh.innerHTML = '<div class="th-title">√ó</div>';
                thead.appendChild(actionsTh);
            }
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            const tableData = getCurrentTabData();
            
            tableData.forEach((rowData, rowIndex) => {
                const row = document.createElement('tr');
                
                // –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Å—Ç—Ä–æ–∫–∏
                const checkboxTd = document.createElement('td');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'row-checkbox';
                checkbox.checked = selectedRows.has(rowData.id);
                checkbox.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        selectedRows.add(rowData.id);
                    } else {
                        selectedRows.delete(rowData.id);
                    }
                });
                checkboxTd.appendChild(checkbox);
                row.appendChild(checkboxTd);
                
                // –ë–∞–∑–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã
                basicColumns.forEach(column => {
                    const td = document.createElement('td');
                    let value = '';
                    
                    switch(column.id) {
                        case 'id': value = rowIndex + 1; break;
                        case 'name': value = rowData.name || ''; break;
                        case 'date': value = rowData.date || ''; break;
                        case 'status': value = rowData.status || ''; break;
                        default: value = rowData[column.id] || '';
                    }
                    
                    td.textContent = value;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
                    const dateValidationColumns = getCurrentTabDateValidationColumns();
                    if (dateValidationColumns[column.id] && value && isValidDate(value)) {
                        const today = new Date();
                        const cellDate = parseDate(value);
                        const timeDiff = cellDate.getTime() - today.getTime();
                        const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                        
                        if (daysDiff < 0) {
                            td.classList.add('date-cell-danger');
                        } else if (daysDiff <= 30) {
                            td.classList.add('date-cell-warning');
                        }
                    }
                    
                    row.appendChild(td);
                });
                
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ç–æ–ª–±—Ü—ã
                customColumns.forEach(column => {
                    const td = document.createElement('td');
                    td.dataset.columnName = column.name; // –í–ê–ñ–ù–û: —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è —Å—Ç–æ–ª–±—Ü–∞
                    
                    const value = rowData.customData && rowData.customData[column.id] 
                        ? rowData.customData[column.id] 
                        : '';
                    
                    td.textContent = value;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
                    const dateValidationColumns = getCurrentTabDateValidationColumns();
                    if (dateValidationColumns[column.id] && value && isValidDate(value)) {
                        const today = new Date();
                        const cellDate = parseDate(value);
                        const timeDiff = cellDate.getTime() - today.getTime();
                        const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                        
                        if (daysDiff < 0) {
                            td.classList.add('date-cell-danger');
                        } else if (daysDiff <= 30) {
                            td.classList.add('date-cell-warning');
                        }
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫–∏ —Ñ–∞–π–ª–æ–≤ –µ—Å–ª–∏ –µ—Å—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è
                    if (rowData.attachments && rowData.attachments[column.id]) {
                        const fileIcons = document.createElement('div');
                        fileIcons.className = 'file-icons';
                        
                        rowData.attachments[column.id].forEach((file, fileIndex) => {
                            const fileIcon = document.createElement('div');
                            fileIcon.className = 'file-icon-small';
                            fileIcon.innerHTML = 'üìé';
                            fileIcon.title = file.name;
                            fileIcons.appendChild(fileIcon);
                        });
                        
                        td.appendChild(fileIcons);
                    }
                    
                    row.appendChild(td);
                });
                
                // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
                if (currentUser && currentUser.role === 'admin') {
                    const actionsTd = document.createElement('td');
                    actionsTd.className = 'admin-only';
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'delete-row-btn';
                    deleteBtn.innerHTML = '√ó';
                    deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É';
                    deleteBtn.onclick = () => deleteRow(rowData.id);
                    actionsTd.appendChild(deleteBtn);
                    row.appendChild(actionsTd);
                }
                
                tbody.appendChild(row);
            });
            
            console.log('‚úÖ –¢–∞–±–ª–∏—Ü–∞ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–∞');
        }

        // –§–£–ù–ö–¶–ò–Ø –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ù–û–í–û–ô –°–¢–†–û–ö–ò
        function addNewRow() {
            if (!currentUser || currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫–∏');
                return;
            }
            
            const currentTab = getCurrentTab();
            if (!currentTab) return;
            
            const tableData = getCurrentTabData();
            const newId = tableData.length > 0 ? Math.max(...tableData.map(row => row.id)) + 1 : 1;
            const newRow = {
                id: newId,
                name: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç',
                date: formatDate(new Date()),
                status: '–ê–∫—Ç–∏–≤–µ–Ω',
                customData: {},
                attachments: {}
            };
            
            tableData.push(newRow);
            updateCurrentTabData(tableData);
            
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            
            renderTable();
        }

        // –§–£–ù–ö–¶–ò–Ø –£–î–ê–õ–ï–ù–ò–Ø –°–¢–†–û–ö–ò
        function deleteRow(rowId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É?')) {
                return;
            }
            
            const tableData = getCurrentTabData();
            const updatedData = tableData.filter(row => row.id !== rowId);
            
            updateCurrentTabData(updatedData);
            selectedRows.delete(rowId);
            
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            
            renderTable();
        }

        // –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –î–ê–¢
        function checkAllDates() {
            console.log('üìÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç...');
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –¥–∞—Ç
            renderTable();
        }

        // –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò –ö–ê–°–¢–û–ú–ù–´–• –ö–ù–û–ü–û–ö
        function loadCustomButtons() {
            const container = document.getElementById('custom-buttons');
            if (!container) return;
            
            container.innerHTML = '';
            
            const customButtons = getCurrentTabCustomButtons();
            customButtons.forEach(button => {
                createCustomButton(button);
            });
            
            console.log(`‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${customButtons.length} –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫`);
        }

        // –§–£–ù–ö–¶–ò–Ø –°–û–ó–î–ê–ù–ò–Ø –ù–û–í–û–ô –í–ö–õ–ê–î–ö–ò
        function createNewTab() {
            if (currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –≤–∫–ª–∞–¥–∫–∏');
                return;
            }

            const tabId = 'tab_' + Date.now();
            const tabName = `–¢–∞–±–ª–∏—Ü–∞ ${tabs.length + 1}`;
            
            const newTab = {
                id: tabId,
                name: tabName,
                tableData: [
                    { id: 1, name: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç', date: formatDate(new Date()), status: '–ê–∫—Ç–∏–≤–µ–Ω', customData: {}, attachments: {} }
                ],
                customButtons: [],
                customColumns: [],
                basicColumns: [
                    { id: 'id', name: '‚Ññ –ø/–ø', editable: false },
                    { id: 'name', name: '–ù–∞–∑–≤–∞–Ω–∏–µ', editable: true },
                    { id: 'date', name: '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', editable: true },
                    { id: 'status', name: '–°—Ç–∞—Ç—É—Å', editable: true }
                ],
                dateValidationColumns: {}
            };
            
            tabs.push(newTab);
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            
            currentTabId = tabId;
            
            renderTabs();
            renderTable();
            loadCustomButtons();
        }

        // –§–£–ù–ö–¶–ò–Ø –†–ï–ù–î–ï–†–ò–ù–ì–ê –í–ö–õ–ê–î–û–ö
        function renderTabs() {
            const container = document.getElementById('tabs-container');
            if (!container) return;
            
            container.innerHTML = '';
            
            tabs.forEach(tab => {
                const tabElement = document.createElement('div');
                tabElement.className = `tab ${tab.id === currentTabId ? 'active' : ''}`;
                tabElement.dataset.tabId = tab.id;
                
                const tabName = document.createElement('span');
                tabName.textContent = tab.name;
                tabName.className = 'tab-name';
                
                const closeBtn = document.createElement('button');
                closeBtn.className = 'tab-close';
                closeBtn.innerHTML = '√ó';
                closeBtn.title = '–ó–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É';
                
                if (currentUser && currentUser.role === 'admin' && tabs.length > 1) {
                    closeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        closeTab(tab.id);
                    });
                } else {
                    closeBtn.style.display = 'none';
                }
                
                tabElement.appendChild(tabName);
                tabElement.appendChild(closeBtn);
                
                tabElement.addEventListener('click', (e) => {
                    if (!e.target.classList.contains('tab-close')) {
                        switchTab(tab.id);
                    }
                });
                
                container.appendChild(tabElement);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            const currentTab = getCurrentTab();
            if (currentTab) {
                document.getElementById('header-title').textContent = currentTab.name;
            }
        }

        // –§–£–ù–ö–¶–ò–Ø –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –í–ö–õ–ê–î–û–ö
        function switchTab(tabId) {
            currentTabId = tabId;
            renderTabs();
            renderTable();
            loadCustomButtons();
        }

        // –§–£–ù–ö–¶–ò–Ø –ó–ê–ö–†–´–¢–ò–Ø –í–ö–õ–ê–î–ö–ò
        function closeTab(tabId) {
            if (currentUser.role !== 'admin') {
                alert('–¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å –≤–∫–ª–∞–¥–∫–∏');
                return;
            }

            if (tabs.length <= 1) return;
            
            const tabIndex = tabs.findIndex(tab => tab.id === tabId);
            if (tabIndex === -1) return;
            
            tabs.splice(tabIndex, 1);
            
            if (tabId === currentTabId) {
                currentTabId = tabs[0].id;
            }
            
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            
            renderTabs();
            renderTable();
            loadCustomButtons();
        }

        // –§–£–ù–ö–¶–ò–Ø –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ö–ù–û–ü–ö–ò
        function handleAddButton(e) {
            e.preventDefault();
            const buttonName = document.getElementById('button-name').value;
            const columnInputs = document.getElementById('columns-container').querySelectorAll('input');
            
            const columns = Array.from(columnInputs)
                .map(input => input.value.trim())
                .filter(name => name !== '');
            
            if (columns.length === 0) {
                alert('–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü');
                return;
            }
            
            const buttonId = 'btn_' + Date.now();
            
            const buttonData = {
                id: buttonId,
                name: buttonName,
                columns: columns
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∫ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
            const currentTab = getCurrentTab();
            if (currentTab) {
                if (!currentTab.customButtons) {
                    currentTab.customButtons = [];
                }
                currentTab.customButtons.push(buttonData);
            }
            
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            
            createCustomButton(buttonData);
            document.getElementById('add-button-modal').style.display = 'none';
            document.getElementById('add-button-form').reset();
            
            console.log(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞: ${buttonName} —Å —Å—Ç–æ–ª–±—Ü–∞–º–∏: ${columns.join(', ')}`);
        }

        // –û–°–¢–ê–í–®–ò–ï–°–Ø –§–£–ù–ö–¶–ò–ò
        function setupEventListeners() {
            // –õ–æ–≥–∏–Ω
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            document.getElementById('logout-btn').addEventListener('click', handleLogout);

            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.getElementById('show-all').addEventListener('click', showAllColumns);
            document.getElementById('add-button').addEventListener('click', () => showModal('add-button-modal'));
            document.getElementById('manage-users').addEventListener('click', () => showModal('users-modal'));
            document.getElementById('check-dates-btn').addEventListener('click', checkAllDates);
            document.getElementById('add-row-btn').addEventListener('click', addNewRow);
            document.getElementById('github-sync-btn').addEventListener('click', () => showModal('github-sync-modal'));
            document.getElementById('save-changes-btn').addEventListener('click', forceSaveChanges);
            document.getElementById('refresh-data-btn').addEventListener('click', loadFromGitHub);

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∞–º–∏
            document.getElementById('new-tab-btn').addEventListener('click', createNewTab);

            // GitHub —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
            document.getElementById('github-sync-form').addEventListener('submit', handleGitHubSettingsSave);
            document.getElementById('sync-now-btn').addEventListener('click', forceSaveChanges);
            document.getElementById('load-from-github-btn').addEventListener('click', loadFromGitHub);

            // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            document.querySelectorAll('.close').forEach(close => {
                close.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            // –§–æ—Ä–º—ã
            document.getElementById('add-button-form').addEventListener('submit', handleAddButton);
            document.getElementById('add-user-form').addEventListener('submit', handleAddUser);
            document.getElementById('column-count').addEventListener('change', generateColumnInputs);

            console.log('‚úÖ –í—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã');
        }

        function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                currentUser = user;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-screen').style.display = 'flex';
                document.getElementById('user-role').textContent = user.role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('user-name-display').textContent = user.username;
                
                if (user.role === 'admin') {
                    document.body.classList.add('admin');
                }
                
                initializeAppWithFallback();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        }

        function handleLogout() {
            currentUser = null;
            document.getElementById('main-screen').style.display = 'none';
            document.getElementById('login-screen').style.display = 'flex';
            document.body.classList.remove('admin');
            document.getElementById('login-form').reset();
        }

        function showAllColumns() {
            const allCells = document.querySelectorAll('#data-table th, #data-table td');
            allCells.forEach(cell => cell.style.display = '');
            console.log('‚úÖ –ü–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã');
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
            
            if (modalId === 'users-modal') {
                renderUsersList();
            } else if (modalId === 'add-button-modal') {
                generateColumnInputs();
            } else if (modalId === 'github-sync-modal') {
                const config = storageManager.getConfig();
                document.getElementById('github-token').value = config.token;
                document.getElementById('github-repo').value = config.repo;
                document.getElementById('github-branch').value = config.branch;
            }
        }

        function generateColumnInputs() {
            const count = parseInt(document.getElementById('column-count').value);
            const container = document.getElementById('columns-container');
            
            container.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const inputGroup = document.createElement('div');
                inputGroup.style.marginBottom = '10px';
                inputGroup.innerHTML = `
                    <input type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ ${i + 1}" required 
                           style="width: 100%; padding: 0.5rem; border: 1px solid #4a4a4a; border-radius: 5px; background: #2f2f2f; color: #ecf0f1;">
                `;
                container.appendChild(inputGroup);
            }
        }

        function handleGitHubSettingsSave(e) {
            e.preventDefault();
            
            const token = document.getElementById('github-token').value;
            const repo = document.getElementById('github-repo').value;
            const branch = document.getElementById('github-branch').value;
            
            if (!token || !repo || !branch) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            storageManager.updateGitHubConfig(token, repo, branch);
            document.getElementById('github-sync-modal').style.display = 'none';
            alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        function loadAppSettings() {
            const headerTitle = document.getElementById('header-title');
            if (headerTitle && appSettings.headerTitle) {
                headerTitle.textContent = appSettings.headerTitle;
            }
            
            const fixedColumnsInput = document.getElementById('fixed-columns-count');
            if (fixedColumnsInput && appSettings.fixedColumnsCount) {
                fixedColumnsInput.value = appSettings.fixedColumnsCount;
            }
        }

        function editButton(buttonId) {
            const currentTab = getCurrentTab();
            if (!currentTab || !currentTab.customButtons) return;
            
            const button = currentTab.customButtons.find(b => b.id === buttonId);
            if (!button) return;
            
            const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–∫–∏:', button.name);
            if (newName && newName.trim() !== '') {
                button.name = newName.trim();
                storageManager.saveToLocalStorage(users, appSettings, tabs);
                autoSyncChanges();
                loadCustomButtons();
            }
        }

        function deleteButton(buttonId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–Ω–æ–ø–∫—É?')) return;
            
            const currentTab = getCurrentTab();
            if (!currentTab || !currentTab.customButtons) return;
            
            currentTab.customButtons = currentTab.customButtons.filter(b => b.id !== buttonId);
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            loadCustomButtons();
        }

        function handleAddUser(e) {
            e.preventDefault();
            const username = document.getElementById('new-username').value;
            const password = document.getElementById('new-password').value;
            const role = document.getElementById('new-role').value;
            
            if (users.find(u => u.username === username)) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            users.push({ username, password, role });
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            renderUsersList();
            document.getElementById('add-user-form').reset();
        }

        function renderUsersList() {
            const container = document.getElementById('users-list');
            container.innerHTML = '';
            
            users.forEach((user, index) => {
                if (user.username === currentUser.username) return;
                
                const div = document.createElement('div');
                div.className = 'user-item';
                div.innerHTML = `
                    <div>
                        <strong>${user.username}</strong>
                        <span class="user-role">${user.role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'}</span>
                    </div>
                    <div class="user-actions">
                        <button class="btn-edit" onclick="editUser(${index})">‚úé</button>
                        <button class="btn-danger" onclick="deleteUser(${index})">√ó</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        window.editUser = function(index) {
            const user = users[index];
            const newUsername = prompt('–ù–æ–≤–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', user.username);
            const newPassword = prompt('–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å):');
            const newRole = confirm('–°–¥–µ–ª–∞—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º?') ? 'admin' : 'user';
            
            if (newUsername) user.username = newUsername;
            if (newPassword) user.password = newPassword;
            user.role = newRole;
            
            storageManager.saveToLocalStorage(users, appSettings, tabs);
            autoSyncChanges();
            renderUsersList();
        };

        window.deleteUser = function(index) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                users.splice(index, 1);
                storageManager.saveToLocalStorage(users, appSettings, tabs);
                autoSyncChanges();
                renderUsersList();
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            const data = storageManager.loadFromLocalStorage();
            users = data.users;
            appSettings = data.appSettings;
            tabs = data.tabs;
            storageManager.pendingChanges = data.pendingChanges;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞
            document.getElementById('login-screen').style.display = 'flex';
            document.getElementById('main-screen').style.display = 'none';
            
            console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ');
        });
    </script>
</body>
</html>
