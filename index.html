<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</title>
    <style>
        /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* ... –≤—Å–µ –≤–∞—à–∏ —Å—Ç–∏–ª–∏ ... */

        .sync-status {
            position: fixed;
            bottom: 10px;
            left: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            z-index: 1000;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .sync-status.syncing {
            background: var(--accent-color);
            color: white;
        }

        .sync-status.error {
            background: #e74c3c;
            color: white;
        }

        .sync-status.success {
            background: #27ae60;
            color: white;
        }

        .sync-status.offline {
            background: #95a5a6;
            color: white;
        }
    </style>
</head>
<body class="theme-orange">
    <!-- –í–µ—Å—å HTML –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="login-screen">
        <div class="login-container">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="main-screen">
        <!-- ... –≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π HTML –∫–æ–¥ ... -->
    </div>

    <!-- –í—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è GitHub Storage
        const GITHUB_CONFIG = {
            owner: 'Viktor15081985',
            repo: 'Transort',
            branch: 'main',
            token: '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'
        };

        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let users = [];
        let tableData = [];
        let appSettings = {};
        let customButtons = [];
        let customColumns = [];
        let basicColumns = [];
        let dateValidationColumns = {};
        let tabs = [];

        // –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        let currentUser = null;
        let currentEditingCell = null;
        let isEditingHeader = false;
        let currentPreviewFile = null;
        let currentSort = { column: null, direction: 'asc' };
        let currentFilters = {};
        let currentDatePicker = null;
        let currentDateInput = null;
        let currentTabId = 'tab1';
        let selectedRows = new Set();
        let searchTerm = '';
        let currentImportData = null;
        let useGitHubStorage = false;

        // GitHub Storage –∫–ª–∞—Å—Å
        class GitHubStorage {
            constructor() {
                this.initialized = false;
                this.config = null;
            }

            async init(config) {
                this.config = config;
                
                if (!this.config.token || this.config.token === 'your_github_token_here') {
                    console.warn('GitHub —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ');
                    return false;
                }
                
                try {
                    const testResponse = await fetch(
                        `https://api.github.com/repos/${this.config.owner}/${this.config.repo}`,
                        {
                            headers: {
                                'Authorization': `token ${this.config.token}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        }
                    );

                    if (!testResponse.ok) {
                        if (testResponse.status === 401) {
                            console.error('GitHub —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–ª');
                            return false;
                        } else if (testResponse.status === 404) {
                            console.error('–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω');
                            return false;
                        }
                        throw new Error(`–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: ${testResponse.status}`);
                    }

                    this.initialized = true;
                    console.log('GitHub Storage –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                    return true;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ GitHub Storage:', error);
                    return false;
                }
            }

            async loadData() {
                if (!this.initialized) {
                    throw new Error('GitHub Storage –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }

                try {
                    const response = await fetch(
                        `https://api.github.com/repos/${this.config.owner}/${this.config.repo}/contents/data.json`,
                        {
                            headers: {
                                'Authorization': `token ${this.config.token}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        }
                    );

                    if (response.status === 404) {
                        console.log('–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                        return null;
                    }

                    if (!response.ok) {
                        if (response.status === 401) {
                            throw new Error('–¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.');
                        }
                        throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status}`);
                    }

                    const data = await response.json();
                    
                    let content;
                    try {
                        content = atob(data.content);
                    } catch (e) {
                        content = decodeURIComponent(escape(atob(data.content)));
                    }
                    
                    return JSON.parse(content);

                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                    throw error;
                }
            }

            async saveData(data) {
                if (!this.initialized) {
                    throw new Error('GitHub Storage –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                }

                try {
                    let sha = null;
                    try {
                        const currentFile = await fetch(
                            `https://api.github.com/repos/${this.config.owner}/${this.config.repo}/contents/data.json`,
                            {
                                headers: {
                                    'Authorization': `token ${this.config.token}`,
                                    'Accept': 'application/vnd.github.v3+json'
                                }
                            }
                        );
                        
                        if (currentFile.ok) {
                            const fileData = await currentFile.json();
                            sha = fileData.sha;
                        }
                    } catch (error) {
                        console.log('–§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π');
                    }

                    const contentString = JSON.stringify(data, null, 2);
                    const content = btoa(unescape(encodeURIComponent(contentString)));
                    
                    const message = `–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: ${new Date().toLocaleString()}`;

                    const response = await fetch(
                        `https://api.github.com/repos/${this.config.owner}/${this.config.repo}/contents/data.json`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `token ${this.config.token}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: message,
                                content: content,
                                sha: sha,
                                branch: this.config.branch
                            })
                        }
                    );

                    if (!response.ok) {
                        const errorData = await response.json();
                        if (response.status === 401) {
                            throw new Error('–¢–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.');
                        }
                        throw new Error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${response.status} - ${errorData.message}`);
                    }

                    console.log('–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ GitHub');
                    return await response.json();

                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                    throw error;
                }
            }
        }

        const githubStorage = new GitHubStorage();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            setupEventListeners();
            await loadAllData();
            loadAppSettings();
            renderTabs();
        }

        async function loadAllData() {
            try {
                showSyncStatus('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...', 'syncing');
                
                useGitHubStorage = await githubStorage.init(GITHUB_CONFIG);
                
                if (useGitHubStorage) {
                    try {
                        const data = await githubStorage.loadData();
                        
                        if (data) {
                            users = data.users || getDefaultUsers();
                            tableData = data.tableData || getDefaultTableData();
                            appSettings = data.appSettings || getDefaultAppSettings();
                            customButtons = data.customButtons || [];
                            customColumns = data.customColumns || [];
                            basicColumns = data.basicColumns || getDefaultBasicColumns();
                            dateValidationColumns = data.dateValidationColumns || {};
                            tabs = data.tabs || getDefaultTabs();
                            
                            showSyncStatus('–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ GitHub', 'success');
                        } else {
                            await loadLocalData();
                            showSyncStatus('–ù–æ–≤—ã–π —Ñ–∞–π–ª –¥–∞–Ω–Ω—ã—Ö', 'success');
                        }
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å GitHub:', error);
                        await loadLocalData();
                        showSyncStatus('–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ—à–∏–±–∫–∞ GitHub)', 'offline');
                    }
                } else {
                    await loadLocalData();
                    showSyncStatus('–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (GitHub –æ—Ç–∫–ª—é—á–µ–Ω)', 'offline');
                }
                
            } catch (error) {
                console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                await loadLocalData();
                showSyncStatus('–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–æ—à–∏–±–∫–∞)', 'error');
            }
        }

        async function loadLocalData() {
            users = JSON.parse(localStorage.getItem('users')) || getDefaultUsers();
            tableData = JSON.parse(localStorage.getItem('tableData')) || getDefaultTableData();
            appSettings = JSON.parse(localStorage.getItem('appSettings')) || getDefaultAppSettings();
            customButtons = JSON.parse(localStorage.getItem('customButtons')) || [];
            customColumns = JSON.parse(localStorage.getItem('customColumns')) || [];
            basicColumns = JSON.parse(localStorage.getItem('basicColumns')) || getDefaultBasicColumns();
            dateValidationColumns = JSON.parse(localStorage.getItem('dateValidationColumns')) || {};
            tabs = JSON.parse(localStorage.getItem('tabs')) || getDefaultTabs();
        }

        function getDefaultUsers() {
            return [
                { username: 'admin', password: 'admin', role: 'admin' },
                { username: 'user', password: 'user', role: 'user' }
            ];
        }

        function getDefaultTableData() {
            const currentDate = formatDate(new Date());
            return [
                { id: 1, name: '–ü—Ä–æ–µ–∫—Ç –ê', date: currentDate, status: '–ê–∫—Ç–∏–≤–µ–Ω', customData: {}, attachments: {} },
                { id: 2, name: '–ü—Ä–æ–µ–∫—Ç –ë', date: currentDate, status: '–ó–∞–≤–µ—Ä—à–µ–Ω', customData: {}, attachments: {} },
                { id: 3, name: '–ü—Ä–æ–µ–∫—Ç –í', date: currentDate, status: '–í –ø—Ä–æ—Ü–µ—Å—Å–µ', customData: {}, attachments: {} }
            ];
        }

        function getDefaultAppSettings() {
            return {
                headerTitle: '–û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ',
                headerLogo: '',
                fixedColumnsCount: 3,
                currentTheme: 'theme-orange'
            };
        }

        function getDefaultBasicColumns() {
            return [
                { id: 'id', name: '‚Ññ –ø/–ø', editable: false },
                { id: 'name', name: '–ù–∞–∑–≤–∞–Ω–∏–µ', editable: true },
                { id: 'date', name: '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', editable: true },
                { id: 'status', name: '–°—Ç–∞—Ç—É—Å', editable: true }
            ];
        }

        function getDefaultTabs() {
            return [
                { id: 'tab1', name: '–û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ', data: null }
            ];
        }

        async function saveAllData() {
            try {
                showSyncStatus('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...', 'syncing');
                
                const dataToSave = {
                    users,
                    tableData,
                    appSettings,
                    customButtons,
                    customColumns,
                    basicColumns,
                    dateValidationColumns,
                    tabs,
                    lastModified: new Date().toISOString()
                };

                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('tableData', JSON.stringify(tableData));
                localStorage.setItem('appSettings', JSON.stringify(appSettings));
                localStorage.setItem('customButtons', JSON.stringify(customButtons));
                localStorage.setItem('customColumns', JSON.stringify(customColumns));
                localStorage.setItem('basicColumns', JSON.stringify(basicColumns));
                localStorage.setItem('dateValidationColumns', JSON.stringify(dateValidationColumns));
                localStorage.setItem('tabs', JSON.stringify(tabs));

                if (useGitHubStorage) {
                    try {
                        await githubStorage.saveData(dataToSave);
                        showSyncStatus('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ GitHub', 'success');
                    } catch (error) {
                        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ GitHub:', error);
                        showSyncStatus('–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–æ—à–∏–±–∫–∞ GitHub)', 'error');
                    }
                } else {
                    showSyncStatus('–õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ', 'success');
                }
                
            } catch (error) {
                console.error('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                showSyncStatus('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            }
        }

        function showSyncStatus(message, type = '') {
            const statusElement = document.getElementById('sync-status');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.className = 'sync-status';
                if (type) {
                    statusElement.classList.add(type);
                }
                
                if (type === 'success') {
                    setTimeout(() => {
                        statusElement.textContent = useGitHubStorage ? '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ' : '–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º';
                        statusElement.className = 'sync-status';
                        if (!useGitHubStorage) {
                            statusElement.classList.add('offline');
                        }
                    }, 3000);
                }
            }
        }

        // –§–£–ù–ö–¶–ò–Ø SETUP EVENT LISTENERS
        function setupEventListeners() {
            // –õ–æ–≥–∏–Ω
            document.getElementById('login-form').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            document.getElementById('logout-btn').addEventListener('click', handleLogout);

            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.getElementById('show-all').addEventListener('click', showAllColumns);
            document.getElementById('add-button').addEventListener('click', () => showModal('add-button-modal'));
            document.getElementById('manage-users').addEventListener('click', () => showModal('users-modal'));
            document.getElementById('check-dates-btn').addEventListener('click', checkAllDates);
            document.getElementById('add-row-btn').addEventListener('click', addNewRow);

            // –ù–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            document.getElementById('new-tab-btn').addEventListener('click', createNewTab);
            document.getElementById('filter-selected-btn').addEventListener('click', filterSelectedRows);
            document.getElementById('export-excel-btn').addEventListener('click', exportToExcel);
            document.getElementById('import-excel-btn').addEventListener('click', () => showModal('import-excel-modal'));
            document.getElementById('table-search').addEventListener('input', handleSearch);
            document.getElementById('search-clear').addEventListener('click', clearSearch);
            document.getElementById('select-all-checkbox').addEventListener('change', handleSelectAll);

            // –ö–Ω–æ–ø–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
            document.getElementById('load-data-btn').addEventListener('click', async function() {
                await loadAllData();
                renderTable();
                renderTabs();
                loadCustomButtons();
            });

            document.getElementById('save-data-btn').addEventListener('click', async function() {
                await saveAllData();
            });

            // –ö–Ω–æ–ø–∫–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤–∫–ª–∞–¥–æ–∫
            document.querySelector('.tabs-scroll-btn.left').addEventListener('click', scrollTabsLeft);
            document.querySelector('.tabs-scroll-btn.right').addEventListener('click', scrollTabsRight);

            // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞–º–∏
            document.getElementById('add-column-btn').addEventListener('click', addNewColumn);
            document.getElementById('remove-column-btn').addEventListener('click', showRemoveColumnModal);
            document.getElementById('fixed-columns-count').addEventListener('change', updateFixedColumnsCount);

            // –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞
            document.getElementById('confirm-remove-column').addEventListener('click', removeSelectedColumn);

            // –ò–º–ø–æ—Ä—Ç Excel
            document.getElementById('excel-upload-area').addEventListener('click', function() {
                document.getElementById('excel-file-input').click();
            });
            document.getElementById('excel-file-input').addEventListener('change', handleExcelFileSelect);
            document.getElementById('confirm-import-btn').addEventListener('click', confirmImport);
            document.getElementById('cancel-import-btn').addEventListener('click', () => {
                document.getElementById('import-excel-modal').style.display = 'none';
            });

            // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
            document.querySelectorAll('.close').forEach(close => {
                close.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            // –§–æ—Ä–º—ã
            document.getElementById('add-button-form').addEventListener('submit', handleAddButton);
            document.getElementById('add-user-form').addEventListener('submit', handleAddUser);
            document.getElementById('column-count').addEventListener('change', generateColumnInputs);
            document.getElementById('save-cell-btn').addEventListener('click', saveCellChanges);

            // –ö–Ω–æ–ø–∫–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            document.getElementById('download-preview-btn').addEventListener('click', downloadPreviewFile);
            document.getElementById('copy-preview-btn').addEventListener('click', copyPreviewFile);
            document.getElementById('print-preview-btn').addEventListener('click', printPreviewFile);

            // –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
            const fileUploadArea = document.getElementById('file-upload-area');
            const fileInput = document.getElementById('file-input');
            
            fileUploadArea.addEventListener('click', function() {
                fileInput.click();
            });

            fileInput.addEventListener('change', function(e) {
                handleFileUpload(e.target.files);
            });

            setupFileDropZone();

            // –õ–æ–≥–æ—Ç–∏–ø
            document.getElementById('header-logo').addEventListener('click', triggerLogoUpload);
            document.getElementById('logo-upload').addEventListener('change', handleLogoUpload);

            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.filter-dropdown') && !e.target.closest('.filter-btn')) {
                    closeAllFilterDropdowns();
                }
                if (!e.target.closest('.date-picker') && !e.target.classList.contains('date-cell')) {
                    closeDatePicker();
                }
                if (!e.target.closest('.date-input-overlay') && currentDateInput) {
                    closeDateInput();
                }
            });

            // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞
            document.addEventListener('mousedown', function(e) {
                if (e.target.closest('.filter-options')) {
                    e.stopPropagation();
                }
            });
        }

        // –ë–ê–ó–û–í–´–ï –§–£–ù–ö–¶–ò–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
                currentUser = user;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-screen').style.display = 'flex';
                document.getElementById('user-role').textContent = user.role === 'admin' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('user-name-display').textContent = user.username;
                
                if (user.role === 'admin') {
                    document.body.classList.add('admin');
                    setupAdminFeatures();
                }
                
                loadCustomButtons();
                renderTable();
                
                setTimeout(() => {
                    checkAllDates();
                }, 1000);
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        }

        function handleLogout() {
            currentUser = null;
            document.getElementById('main-screen').style.display = 'none';
            document.getElementById('login-screen').style.display = 'flex';
            document.body.classList.remove('admin');
        }

        function setupAdminFeatures() {
            const headerTitle = document.getElementById('header-title');
            headerTitle.classList.add('editable');
            headerTitle.contentEditable = 'true';
            headerTitle.addEventListener('blur', function() {
                appSettings.headerTitle = this.textContent;
                saveAllData();
            });
            
            headerTitle.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.blur();
                }
            });

            document.getElementById('fixed-columns-count').value = appSettings.fixedColumnsCount;
        }

        function loadAppSettings() {
            document.getElementById('header-title').textContent = appSettings.headerTitle;
            if (appSettings.headerLogo) {
                document.getElementById('header-logo').src = appSettings.headerLogo;
                document.getElementById('header-logo').style.display = 'block';
            }
            document.getElementById('fixed-columns-count').value = appSettings.fixedColumnsCount;
        }

        function showAllColumns() {
            const allCells = document.querySelectorAll('#data-table th, #data-table td');
            allCells.forEach(cell => cell.style.display = '');
        }

        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –§–ê–ô–õ–ê–ú–ò
        function setupFileDropZone() {
            const dropZone = document.getElementById('file-upload-area');
            
            dropZone.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.style.borderColor = '#e67e22';
                this.style.background = '#3a3a3a';
            });
            
            dropZone.addEventListener('dragleave', function(e) {
                e.preventDefault();
                this.style.borderColor = '#4a4a4a';
                this.style.background = '#2f2f2f';
            });
            
            dropZone.addEventListener('drop', function(e) {
                e.preventDefault();
                this.style.borderColor = '#4a4a4a';
                this.style.background = '#2f2f2f';
                handleFileUpload(e.dataTransfer.files);
            });
        }

        async function handleFileUpload(files) {
            if (!currentEditingCell || isEditingHeader) {
                alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —è—á–µ–π–∫—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!');
                return;
            }
            
            const columnId = currentEditingCell.dataset.columnId;
            const rowId = parseInt(currentEditingCell.closest('tr').querySelector('td:nth-child(2)').textContent);
            
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    const rowData = tableData.find(row => row.id === rowId);
                    if (!rowData.attachments) rowData.attachments = {};
                    if (!rowData.attachments[columnId]) rowData.attachments[columnId] = [];
                    
                    rowData.attachments[columnId].push({
                        name: file.name,
                        type: file.type,
                        data: e.target.result
                    });
                    
                    const currentTab = tabs.find(tab => tab.id === currentTabId);
                    if (currentTab) {
                        currentTab.data = JSON.parse(JSON.stringify(tableData));
                    }
                    
                    await saveAllData();
                    
                    loadAttachedFiles(currentEditingCell);
                    renderTable();
                    
                    alert(`–§–∞–π–ª "${file.name}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!`);
                };
                
                reader.onerror = function(e) {
                    alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ "${file.name}"`);
                };
                
                reader.readAsDataURL(file);
            });
        }

        function triggerLogoUpload() {
            if (currentUser && currentUser.role === 'admin') {
                document.getElementById('logo-upload').click();
            }
        }

        async function handleLogoUpload(e) {
            const file = e.target.files[0];
            if (file && file.type === 'image/png') {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('header-logo').src = e.target.result;
                    document.getElementById('header-logo').style.display = 'block';
                    appSettings.headerLogo = e.target.result;
                    saveAllData();
                };
                reader.readAsDataURL(file);
            } else {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ PNG —Ñ–∞–π–ª');
            }
        }

        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –î–ê–¢–ê–ú–ò
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}.${month}.${year}`;
        }

        function isValidDate(dateString) {
            const regex = /^\d{2}\.\d{2}\.\d{4}$/;
            if (!regex.test(dateString)) return false;
            
            const parts = dateString.split('.');
            const day = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1;
            const year = parseInt(parts[2], 10);
            
            const date = new Date(year, month, day);
            return date.getDate() === day && date.getMonth() === month && date.getFullYear() === year;
        }

        function parseDate(dateString) {
            if (!dateString) return new Date();
            const regex = /^\d{2}\.\d{2}\.\d{4}$/;
            if (!regex.test(dateString)) return new Date();
            
            const parts = dateString.split('.');
            const day = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1;
            const year = parseInt(parts[2], 10);
            
            return new Date(year, month, day);
        }

        function checkAllDates() {
            const expiredDates = [];
            const upcomingDates = [];
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            tableData.forEach(row => {
                basicColumns.forEach(column => {
                    if (dateValidationColumns[column.id] && row[column.id]) {
                        checkDateCell(row, column.id, column.name, today, expiredDates, upcomingDates);
                    }
                });
                
                customColumns.forEach(column => {
                    if (dateValidationColumns[column.id] && row.customData && row.customData[column.id]) {
                        checkDateCell(row, column.id, column.name, today, expiredDates, upcomingDates);
                    }
                });
            });
            
            showDateNotifications(expiredDates, upcomingDates);
            renderTable();
        }

        function checkDateCell(row, columnId, columnName, today, expiredDates, upcomingDates) {
            let dateValue;
            
            if (customColumns.find(col => col.id === columnId)) {
                dateValue = row.customData[columnId];
            } else {
                dateValue = row[columnId];
            }
            
            if (isValidDate(dateValue)) {
                const cellDate = parseDate(dateValue);
                const timeDiff = cellDate.getTime() - today.getTime();
                const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                
                if (daysDiff < 0) {
                    expiredDates.push({
                        date: dateValue,
                        columnName: columnName,
                        rowName: row.name || '',
                        rowStatus: row.status || '',
                        daysOverdue: Math.abs(daysDiff)
                    });
                } else if (daysDiff <= 30) {
                    upcomingDates.push({
                        date: dateValue,
                        columnName: columnName,
                        rowName: row.name || '',
                        rowStatus: row.status || '',
                        daysLeft: daysDiff
                    });
                }
            }
        }

        function showDateNotifications(expiredDates, upcomingDates) {
            const oldNotification = document.querySelector('.notification-panel');
            if (oldNotification) {
                oldNotification.remove();
            }
            
            if (expiredDates.length === 0 && upcomingDates.length === 0) {
                return;
            }
            
            const notificationPanel = document.createElement('div');
            notificationPanel.className = 'notification-panel';
            
            let notificationHTML = `
                <div class="notification-header">
                    <h4>üîî –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç</h4>
                    <button class="close-notifications">√ó</button>
                </div>
                <div class="notification-content">
            `;
            
            if (expiredDates.length > 0) {
                notificationHTML += `<h5 style="color: #e67e22; margin-bottom: 10px;">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –¥–∞—Ç—ã (${expiredDates.length}):</h5>`;
                expiredDates.forEach(item => {
                    notificationHTML += `
                        <div class="notification-item danger">
                            <strong>${item.date}</strong> - –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ –Ω–∞ ${item.daysOverdue} –¥–Ω.<br>
                            <small>${item.columnName} | ${item.rowName} | ${item.rowStatus}</small>
                        </div>
                    `;
                });
            }
            
            if (upcomingDates.length > 0) {
                notificationHTML += `<h5 style="color: #e67e22; margin-bottom: 10px; margin-top: 15px;">–ü—Ä–∏–±–ª–∏–∂–∞—é—â–∏–µ—Å—è –¥–∞—Ç—ã (${upcomingDates.length}):</h5>`;
                upcomingDates.forEach(item => {
                    notificationHTML += `
                        <div class="notification-item warning">
                            <strong>${item.date}</strong> - –æ—Å—Ç–∞–ª–æ—Å—å ${item.daysLeft} –¥–Ω.<br>
                            <small>${item.columnName} | ${item.rowName} | ${item.rowStatus}</small>
                        </div>
                    `;
                });
            }
            
            notificationHTML += `</div>`;
            notificationPanel.innerHTML = notificationHTML;
            
            document.body.appendChild(notificationPanel);
            
            notificationPanel.querySelector('.close-notifications').addEventListener('click', function() {
                notificationPanel.remove();
            });
        }

        // –ë–ê–ó–û–í–´–ï –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –¢–ê–ë–õ–ò–¶–ï–ô
        function renderTable() {
            const tbody = document.querySelector('#data-table tbody');
            tbody.innerHTML = '';
            
            let filteredData = applyFilters(tableData);
            filteredData = applySearch(filteredData);
            let sortedData = applySorting(filteredData);
            
            sortedData.forEach((rowData, index) => {
                rowData.displayId = index + 1;
            });
            
            sortedData.forEach(rowData => {
                const row = document.createElement('tr');
                
                // –ß–µ–∫–±–æ–∫—Å
                const checkboxTd = document.createElement('td');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'row-checkbox';
                checkbox.dataset.rowId = rowData.id;
                checkbox.checked = selectedRows.has(rowData.id);
                checkbox.addEventListener('change', (e) => {
                    handleRowCheckboxChange(rowData.id, e.target.checked);
                });
                checkboxTd.appendChild(checkbox);
                row.appendChild(checkboxTd);
                
                // –ë–∞–∑–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã
                basicColumns.forEach(column => {
                    const td = document.createElement('td');
                    if (column.editable && currentUser && currentUser.role === 'admin') {
                        td.classList.add('editable');
                    }
                    
                    let value = '';
                    switch(column.id) {
                        case 'id': value = rowData.displayId || rowData.id; break;
                        case 'name': value = rowData.name || ''; break;
                        case 'date': value = rowData.date || ''; break;
                        case 'status': value = rowData.status || ''; break;
                    }
                    
                    td.textContent = value;
                    row.appendChild(td);
                });
                
                // –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã
                customColumns.forEach(column => {
                    const td = document.createElement('td');
                    if (currentUser && currentUser.role === 'admin') {
                        td.classList.add('editable');
                    }
                    
                    const value = rowData.customData && rowData.customData[column.id] 
                        ? rowData.customData[column.id] 
                        : '';
                    
                    td.textContent = value;
                    row.appendChild(td);
                });
                
                // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
                if (currentUser && currentUser.role === 'admin') {
                    const actionsTd = document.createElement('td');
                    actionsTd.className = 'admin-only';
                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'delete-row-btn';
                    deleteBtn.innerHTML = '√ó';
                    deleteBtn.title = '–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É';
                    deleteBtn.onclick = () => deleteRow(rowData.id);
                    actionsTd.appendChild(deleteBtn);
                    row.appendChild(actionsTd);
                }
                
                tbody.appendChild(row);
            });
        }

        async function addNewRow() {
            const newId = tableData.length > 0 ? Math.max(...tableData.map(row => row.id)) + 1 : 1;
            const newRow = {
                id: newId,
                name: '–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç',
                date: formatDate(new Date()),
                status: '–ê–∫—Ç–∏–≤–µ–Ω',
                customData: {},
                attachments: {}
            };
            
            tableData.push(newRow);
            await saveAllData();
            renderTable();
        }

        async function deleteRow(rowId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É?')) {
                return;
            }
            
            tableData = tableData.filter(row => row.id !== rowId);
            selectedRows.delete(rowId);
            await saveAllData();
            renderTable();
        }

        // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        function handleSelectAll(e) {
            const isChecked = e.target.checked;
            const checkboxes = document.querySelectorAll('.row-checkbox');
            checkboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
                handleRowCheckboxChange(parseInt(checkbox.dataset.rowId), isChecked);
            });
        }

        function handleRowCheckboxChange(rowId, isChecked) {
            if (isChecked) {
                selectedRows.add(rowId);
            } else {
                selectedRows.delete(rowId);
            }
        }

        function filterSelectedRows() {
            if (selectedRows.size === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏!');
                return;
            }
            
            currentFilters.selectedRows = Array.from(selectedRows);
            renderTable();
        }

        function handleSearch(e) {
            searchTerm = e.target.value.toLowerCase().trim();
            renderTable();
        }

        function clearSearch() {
            document.getElementById('table-search').value = '';
            searchTerm = '';
            renderTable();
        }

        function applySearch(data) {
            if (!searchTerm) return data;
            
            return data.filter(row => {
                const searchableFields = [
                    row.id.toString(),
                    row.name || '',
                    row.date || '',
                    row.status || ''
                ];
                
                if (row.customData) {
                    Object.values(row.customData).forEach(value => {
                        searchableFields.push(value.toString());
                    });
                }
                
                return searchableFields.some(field => 
                    field.toLowerCase().includes(searchTerm)
                );
            });
        }

        function applyFilters(data) {
            if (Object.keys(currentFilters).length === 0) return data;
            
            return data.filter(row => {
                return Object.entries(currentFilters).every(([filterType, filterValue]) => {
                    if (filterType === 'selectedRows') {
                        return filterValue.includes(row.id);
                    }
                    return true;
                });
            });
        }

        function applySorting(data) {
            if (!currentSort.column) return data;
            
            return [...data].sort((a, b) => {
                let valueA, valueB;
                
                if (customColumns.find(col => col.id === currentSort.column)) {
                    valueA = a.customData && a.customData[currentSort.column] ? a.customData[currentSort.column] : '';
                    valueB = b.customData && b.customData[currentSort.column] ? b.customData[currentSort.column] : '';
                } else {
                    switch(currentSort.column) {
                        case 'id': valueA = a.id; valueB = b.id; break;
                        case 'name': valueA = a.name || ''; valueB = b.name || ''; break;
                        case 'date': valueA = a.date || ''; valueB = b.date || ''; break;
                        case 'status': valueA = a.status || ''; valueB = b.status || ''; break;
                        default: valueA = ''; valueB = '';
                    }
                }
                
                if (currentSort.direction === 'asc') {
                    return valueA < valueB ? -1 : valueA > valueB ? 1 : 0;
                } else {
                    return valueA > valueB ? -1 : valueA < valueB ? 1 : 0;
                }
            });
        }

        // –ó–ê–ì–õ–£–®–ö–ò –î–õ–Ø –ù–ï–†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–• –§–£–ù–ö–¶–ò–ô
        function renderTabs() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∞ –≤–∫–ª–∞–¥–æ–∫
            console.log('Render tabs function called');
        }

        function loadCustomButtons() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
            console.log('Load custom buttons function called');
        }

        function createNewTab() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
            alert('–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function scrollTabsLeft() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤–∫–ª–∞–¥–æ–∫ –≤–ª–µ–≤–æ
            console.log('Scroll tabs left');
        }

        function scrollTabsRight() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –≤–∫–ª–∞–¥–æ–∫ –≤–ø—Ä–∞–≤–æ
            console.log('Scroll tabs right');
        }

        function addNewColumn() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
            alert('–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function showRemoveColumnModal() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞
            alert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function removeSelectedColumn() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
            alert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function updateFixedColumnsCount() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
            console.log('Update fixed columns count');
        }

        function handleExcelFileSelect() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞ Excel —Ñ–∞–π–ª–∞
            alert('–§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function confirmImport() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–º–ø–æ—Ä—Ç–∞
            alert('–§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function showModal(modalId) {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById(modalId).style.display = 'flex';
        }

        function generateColumnInputs() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
            console.log('Generate column inputs');
        }

        function handleAddButton(e) {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏
            e.preventDefault();
            alert('–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function handleAddUser(e) {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            e.preventDefault();
            alert('–§—É–Ω–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function saveCellChanges() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —è—á–µ–π–∫–∏
            alert('–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —è—á–µ–π–∫–∏ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function downloadPreviewFile() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            alert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–æ–≤ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function copyPreviewFile() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            alert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–æ–≤ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function printPreviewFile() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏ —Ñ–∞–π–ª–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
            alert('–§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∞–π–ª–æ–≤ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        function loadAttachedFiles(cell) {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
            console.log('Load attached files');
        }

        function closeAllFilterDropdowns() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
            console.log('Close all filter dropdowns');
        }

        function closeDatePicker() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è date picker
            console.log('Close date picker');
        }

        function closeDateInput() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è date input
            console.log('Close date input');
        }

        function exportToExcel() {
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel
            alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è –≤–ª–æ–∂–µ–Ω–∏–π
        window.removeAttachment = async function(rowId, columnId, fileIndex) {
            alert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –≤–ª–æ–∂–µ–Ω–∏–π –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        };

        // –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
        window.editUser = async function(index) {
            alert('–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        };

        window.deleteUser = async function(index) {
            alert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–∑–∂–µ');
        };

    </script>
</body>
</html>
